Shared Infrastructure
Cross-cutting utilities, clients, errors, middleware, and services shared across modules.

The common module provides foundational infrastructure used by all bounded contexts: email sending, webhook delivery, token counting, PII anonymization, external API clients (code-execution, Docling, Locaboo, Presidio), request-scoped context, error handling, pagination, logging, guards, validators, middleware, and database base records.

The common module is the shared kernel of the backend, imported globally or by individual domain and IAM modules. It contains no business logic but provides essential infrastructure services. Key subdirectories include `emails/` for SMTP-based email delivery, `webhooks/` for HTTP webhook dispatch on lifecycle events, `token-counter/` for LLM token estimation via tiktoken or simple heuristics, `context/` for request-scoped user identity using `nestjs-cls`, and `errors/` for the base `ApplicationError` class and global exception filter. Additional capabilities include `anonymization/` for PII detection via Presidio, `email-templates/` for MJML-rendered transactional emails, `clients/` for external API integrations, `pagination/` for standardized paginated queries and responses, `logger/` for Winston+Sentry structured logging, `middleware/` for cookie parsing and security headers, `guards/` for the `@Public()` decorator bypassing JWT, `validators/` for JSON schema validation, `filters/` for converting domain errors to HTTP responses with Sentry enrichment, and `db/` for the `BaseRecord` TypeORM superclass with UUID primary key and timestamp columns.
