Database Layer
TypeORM datasource, migrations, fixtures, and seed scripts for PostgreSQL.

The db directory manages the PostgreSQL database lifecycle. It contains the TypeORM `DataSource` initialization (with pgvector support), ~45 sequential migrations tracking every schema change, a minimal development fixture, and seed scripts that directly use TypeORM repositories to populate test data outside of NestJS dependency injection.

The `datasource.ts` file creates and exports a standalone TypeORM `DataSource` used by both the application and migration CLI. It applies a hack to register `vector` as a supported column type for pgvector compatibility. The `migrations/` directory contains chronologically ordered migration files (timestamped from `1750087277319-InitialSchema` through `1769698433926-AddGemini`) covering the full schema evolution: initial tables, subscriptions, models, permitted providers, legal acceptances, agents, threads, sources, RAG vectors, MCP integrations, shares, teams, usage tracking, and multi-provider support. The `fixtures/` directory holds `minimal.fixture.ts` defining a canonical development dataset (one org, admin user, GPT-4o-mini model, active subscription). The `scripts/` directory contains `seed-minimal.ts`, a standalone script that initializes the datasource directly, creates fixture data using raw TypeORM repositories (bypassing NestJS DI), and handles idempotent seeding with existence checks. A `SeedRunner` utility provides password hashing and production environment guards.
